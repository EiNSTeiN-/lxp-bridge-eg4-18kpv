#! /usr/bin/ruby
#
require 'socket'

heartbeat = [161, 26, 2, 0, 13, 0, 1, 193, 66, 65, 49, 57, 53, 50, 48, 51, 57, 51, 0]

read_input_1 = [161, 26, 2, 0, 111, 0, 1, 194, 66, 65, 49, 57, 53, 50, 48, 51, 57, 51, 97, 0, 1, 4, 48, 49, 48, 50, 48, 48, 53, 48, 53, 48, 0, 0, 80, 0, 0, 77, 0, 1, 0, 2, 0, 237, 1, 43, 100, 0, 1, 0, 0, 0, 0, 0, 0, 0,0, 0, 0, 140, 9, 1, 1, 4, 0, 135, 19, 0, 0, 0, 0, 0, 0, 232, 3, 141, 9, 0, 1, 96, 60, 135, 19, 0, 0, 0, 0, 0, 0, 249, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,0, 0, 0, 0, 0, 3, 0, 174, 14, 228, 11, 161, 104]

read_input_2 = [161, 26, 2, 0, 111, 0, 1, 194, 66, 65, 49, 57, 53, 50, 48, 51, 57, 51, 97, 0, 1, 4, 48, 49, 48, 50, 48, 48, 53, 48, 53, 48, 40, 0, 80, 130, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 246, 0, 0, 0, 138, 0, 0, 0, 202, 0, 0, 0, 198, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 58, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 32, 0, 20, 0, 22, 0, 0, 0, 0, 0, 196, 44, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 46, 16, 23, 177]

read_input_3 = [161, 26, 2, 0, 111, 0, 1, 194, 66, 65, 49, 57, 53, 50, 48, 51, 57, 51, 97, 0, 1, 4, 48, 49, 48, 50, 48, 48, 53, 48, 53, 48, 80, 0, 80, 10, 0, 136, 19, 136, 19, 20, 2, 144, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 192, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 2, 0, 100, 0, 206, 255, 0, 0, 0, 0, 255, 255, 255, 255, 206, 0, 206, 0, 0, 0, 0, 0, 236, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 48, 49, 48, 50, 48, 48, 53, 48, 53, 48, 81, 90]

read_hold_21 = [161, 26, 1, 0, 32, 0, 1, 194, 65, 66, 49, 50, 51, 52, 53, 54, 55, 56, 18, 0, 0, 3, 49, 50, 51, 52, 53, 54, 55, 56, 57, 48, 21, 0, 1, 0, 241, 72]

server = TCPServer.new('127.0.0.1', 30000)

loop {
  client = server.accept

    #client.write(heartbeat.pack('C*'))
    #client.write(read_input_1.pack('C*'))
    p client.read(38)
    sleep 5
    p client.write(read_hold_21.pack('C*'))
    sleep 5
    p client.write(read_hold_21.pack('C*'))
    sleep 5

  client.close
}
